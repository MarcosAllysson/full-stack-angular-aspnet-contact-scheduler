"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[139],{6139:(W,_,a)=>{a.r(_),a.d(_,{ListingComponent:()=>B});var t=a(5849),l=a(95),u=a(6814),m=a(3784),d=a(7213),g=a(707),h=a(3714),f=a(9663),v=a(8057),C=a(7018),Z=a(7680),T=a(1531),E=a(9967),b=a(5048),p=a(5219),A=a(3259),P=a(5648);const U=["dt"];function D(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",30)(1,"p-iconField",31)(2,"p-inputIcon"),t._UZ(3,"i",32),t.qZA(),t.TgZ(4,"input",33),t.NdJ("input",function(o){t.CHM(e);const r=t.oxw(),c=t.MAs(5);return t.KtG(r.onGlobalFilter(c,o))}),t.qZA()()()}}function x(n,s){1&n&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"A\xe7\xf5es"),t.qZA(),t.TgZ(3,"th",34),t._uU(4,"Nome "),t._UZ(5,"p-sortIcon",35),t.qZA(),t.TgZ(6,"th",36),t._uU(7,"E-mail "),t._UZ(8,"p-sortIcon",37),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Celular"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Telefone"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Favorito"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Ativo"),t.qZA()())}function M(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"div",38)(3,"p-button",39),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.editContact(r))}),t.qZA(),t.TgZ(4,"p-button",40),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.deleteContact(r))}),t.qZA()()(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA()()}if(2&n){const e=s.$implicit,i=t.oxw();t.xp6(3),t.Q6J("rounded",!0)("outlined",!0),t.xp6(1),t.Q6J("rounded",!0)("outlined",!0),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.email),t.xp6(2),t.Oqu(i.formatNumber(e.cellPhone,!0)),t.xp6(2),t.Oqu(i.formatNumber(e.phone)),t.xp6(2),t.Oqu(e.isFavorite?"Sim":"N\xe3o"),t.xp6(2),t.Oqu(e.isActive?"Sim":"N\xe3o")}}function O(n,s){if(1&n&&t._uU(0),2&n){const e=t.oxw();t.hij(" No total, h\xe1 ",e.data?e.data.length:0," contato(s). ")}}const F=()=>({width:"50px",height:"50px"});function y(n,s){1&n&&t._UZ(0,"p-progressSpinner",41),2&n&&t.Akn(t.DdM(2,F))}function L(n,s){1&n&&(t.TgZ(0,"small",42),t._uU(1," Nome \xe9 obrigat\xf3rio (m\xednimo 3 caracteres) "),t.qZA())}function I(n,s){1&n&&(t.TgZ(0,"small",42),t._uU(1," Email inv\xe1lido "),t.qZA())}function N(n,s){1&n&&(t.TgZ(0,"small",42),t._uU(1," Celular inv\xe1lido "),t.qZA())}function q(n,s){1&n&&(t.TgZ(0,"small",42),t._uU(1," Telefone inv\xe1lido "),t.qZA())}function S(n,s){1&n&&(t.TgZ(0,"div",23),t._UZ(1,"p-checkbox",43),t.TgZ(2,"label",44),t._uU(3,"Ativo"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("binary",!0))}const J=()=>({"min-width":"50rem"}),k=()=>[5,10,20],K=()=>["name","email","cellPhone","phone"],R=()=>({width:"450px"});let B=(()=>{class n{constructor(){this.data=[],this.loading=!0,this.contactDialog=!1,this._fb=(0,t.f3M)(l.qu),this._messageService=(0,t.f3M)(p.ez),this._contactService=(0,t.f3M)(b.y),this.contactForm=this._fb.group({id:[{value:"",disabled:!0}],name:["",[l.kI.required,l.kI.minLength(3)]],email:["",[l.kI.required,l.kI.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],cellPhone:["",[l.kI.required,l.kI.pattern(/^\(\d{2}\) \d \d{4}-\d{4}$/)]],phone:["",[l.kI.required,l.kI.pattern(/^\(\d{2}\) \d{4}-\d{4}$/)]],isFavorite:[!1],isActive:[!0]})}ngOnInit(){this.loadContacts()}loadContacts(){this.loading=!0,this._contactService.getContacts().subscribe({next:e=>{this.data=e,this.loading=!1},error:e=>{this.loading=!1,this._messageService.add({severity:"error",summary:"Erro",detail:"Falha ao carregar contatos"})}})}openNew(){this.contactForm.reset({isFavorite:!1,isActive:!0}),this.contactDialog=!0}editContact(e){Object.keys(this.contactForm.controls).forEach(i=>{const o=this.contactForm.get(i);o.setErrors(null),o.markAsUntouched()}),this.contactForm.patchValue(e),Object.keys(e).forEach(i=>{if(null!=e[i]){const o=this.contactForm.get(i);o&&(o.setErrors(null),o.markAsTouched())}}),this.contactDialog=!0}saveContact(){if(this.contactForm.invalid)return void this._messageService.add({severity:"warn",summary:"Aten\xe7\xe3o",detail:"Preencha todos os campos corretamente"});const e=this.contactForm.getRawValue();this.cleanPhoneNumbers(e),e.id?this.updateContact(e):this.createContact(e)}cleanPhoneNumbers(e){return e.cellPhone=e.cellPhone.replace(/\D+/g,""),e.phone=e.phone.replace(/\D+/g,""),e}formatNumber(e,i=!1){return(0,P.u)(e,i)}createContact(e){this._contactService.createContact(e).subscribe({next:i=>{this.loadContacts(),this.contactDialog=!1,this._messageService.add({severity:"success",summary:"Sucesso",detail:"Contato criado"})},error:()=>{this._messageService.add({severity:"error",summary:"Erro",detail:"Falha ao criar contato"})}})}updateContact(e){this._contactService.updateContact(e.id,e).subscribe({next:i=>{this.contactDialog=!1,this.loadContacts(),this._messageService.add({severity:"success",summary:"Sucesso",detail:"Contato atualizado"})},error:()=>{this._messageService.add({severity:"error",summary:"Erro",detail:"Falha ao atualizar contato"})}})}deleteContact(e){this._contactService.deactivateContact(e.id).subscribe({next:()=>{this.loadContacts(),this._messageService.add({severity:"success",summary:"Sucesso",detail:"Contato removido"})},error:()=>{this._messageService.add({severity:"error",summary:"Erro",detail:"Falha ao remover contato"})}})}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-listing"]],viewQuery:function(i,o){if(1&i&&t.Gf(U,5),2&i){let r;t.iGM(r=t.CRH())&&(o.table=r.first)}},standalone:!0,features:[t._Bn([p.ez]),t.jDz],decls:42,vars:25,consts:[[1,"card"],[1,"flex","justify-content-between","mb-3"],["label","Novo Contato","icon","pi pi-plus","severity","success",3,"click"],["stripedRows","",3,"value","loading","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","loading"],["header","Contato",3,"visible","modal","visibleChange"],[3,"formGroup","ngSubmit"],[1,"grid","p-fluid","mt-3"],[1,"col-12"],["for","name"],["id","name","type","text","pInputText","","formControlName","name","placeholder","Digite o nome"],["class","p-error",4,"ngIf"],["for","email"],["id","email","type","text","pInputText","","formControlName","email","placeholder","Digite o email"],["for","cellPhone"],["id","cellPhone","formControlName","cellPhone","mask","(99) 9 9999-9999","placeholder","(99) 9 9999-9999"],["for","phone"],["id","phone","formControlName","phone","mask","(99) 9999-9999","placeholder","(99) 9999-9999"],[1,"col-12","flex","items-center"],["formControlName","isFavorite","inputId","isFavorite",3,"binary"],["for","isFavorite",1,"ml-2"],["class","col-12 flex items-center"],[1,"flex","justify-content-end","mt-4"],["label","Cancelar","icon","pi pi-times","severity","secondary",3,"text","click"],["label","Salvar","icon","pi pi-check","type","submit","tooltipPosition","bottom",3,"disabled","pTooltip"],[1,"flex","items-center","justify-content-end"],["iconPosition","left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Pesquise um contato",3,"input"],["pSortableColumn","name"],["field","name"],["pSortableColumn","email"],["field","email"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","warning","pTooltip","Editar contato","tooltipPosition","top",3,"rounded","outlined","click"],["icon","pi pi-trash","severity","danger","pTooltip","Deletar contato","tooltipPosition","top",3,"rounded","outlined","click"],["strokeWidth","8","fill","transparent","animationDuration",".5s"],[1,"p-error"],["formControlName","isActive","inputId","isActive",3,"binary"],["for","isActive",1,"ml-2"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"p-toast"),t.TgZ(2,"div",1)(3,"p-button",2),t.NdJ("click",function(){return o.openNew()}),t.qZA()(),t.TgZ(4,"p-table",3,4),t.YNc(6,D,5,0,"ng-template",5)(7,x,17,0,"ng-template",6)(8,M,17,10,"ng-template",7)(9,O,1,1,"ng-template",8)(10,y,1,3,"ng-template",9),t.qZA(),t.TgZ(11,"p-dialog",10),t.NdJ("visibleChange",function(c){return o.contactDialog=c}),t.TgZ(12,"form",11),t.NdJ("ngSubmit",function(){return o.saveContact()}),t.TgZ(13,"div",12)(14,"div",13)(15,"label",14),t._uU(16,"Nome"),t.qZA(),t._UZ(17,"input",15),t.YNc(18,L,2,0,"small",16),t.qZA(),t.TgZ(19,"div",13)(20,"label",17),t._uU(21,"Email"),t.qZA(),t._UZ(22,"input",18),t.YNc(23,I,2,0,"small",16),t.qZA(),t.TgZ(24,"div",13)(25,"label",19),t._uU(26,"Celular"),t.qZA(),t._UZ(27,"p-inputMask",20),t.YNc(28,N,2,0,"small",16),t.qZA(),t.TgZ(29,"div",13)(30,"label",21),t._uU(31,"Telefone"),t.qZA(),t._UZ(32,"p-inputMask",22),t.YNc(33,q,2,0,"small",16),t.qZA(),t.TgZ(34,"div",23),t._UZ(35,"p-checkbox",24),t.TgZ(36,"label",25),t._uU(37,"Favorito"),t.qZA()(),t.YNc(38,S,4,1,"div",26),t.qZA(),t.TgZ(39,"div",27)(40,"p-button",28),t.NdJ("click",function(){return o.contactDialog=!1}),t.qZA(),t._UZ(41,"p-button",29),t.qZA()()()()),2&i&&(t.xp6(4),t.Q6J("value",o.data)("loading",o.loading)("tableStyle",t.DdM(21,J))("paginator",!0)("rows",5)("rowsPerPageOptions",t.DdM(22,k))("globalFilterFields",t.DdM(23,K)),t.xp6(7),t.Akn(t.DdM(24,R)),t.Q6J("visible",o.contactDialog)("modal",!0),t.xp6(1),t.Q6J("formGroup",o.contactForm),t.xp6(6),t.Q6J("ngIf",o.contactForm.get("name").invalid&&o.contactForm.get("name").touched),t.xp6(5),t.Q6J("ngIf",o.contactForm.get("email").invalid&&o.contactForm.get("email").touched),t.xp6(5),t.Q6J("ngIf",o.contactForm.get("cellPhone").invalid&&o.contactForm.get("cellPhone").touched),t.xp6(5),t.Q6J("ngIf",o.contactForm.get("phone").invalid&&o.contactForm.get("phone").touched),t.xp6(2),t.Q6J("binary",!0),t.xp6(3),t.um2(38,o.contactForm.get("id").value?38:-1),t.xp6(2),t.Q6J("text",!0),t.xp6(1),t.s9C("pTooltip",o.contactForm.get("id").value?"Atualizar contato existente":"Criar novo contato"),t.Q6J("disabled",o.contactForm.invalid))},dependencies:[u.ez,u.O5,l.UX,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,m.U$,m.iA,p.jx,m.lQ,m.fz,d.S,d.V,g.hJ,g.zx,h.j,h.o,f.zz,f.vy,v.nD,v.XZ,C.EV,C.FN,Z.L,Z.G,T.s,T.D,E.n,E.S,A.z,A.u],styles:["[_nghost-%COMP%]{display:block}"]})}return n})()}}]);